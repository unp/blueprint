/*
 * Copyright 2015 Palantir Technologies, Inc. All rights reserved.
 * Licensed under the BSD-3 License as modified (the “License”); you may obtain a copy
 * of the license at https://github.com/palantir/blueprint/blob/master/LICENSE
 * and https://github.com/palantir/blueprint/blob/master/PATENTS
 */
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var core_1 = require("@blueprintjs/core");
var classNames = require("classnames");
var React = require("react");
var Classes = require("./common/classes");
var Utils = require("./common/utils");
var DatePickerCaption = (function (_super) {
    __extends(DatePickerCaption, _super);
    function DatePickerCaption() {
        var _this = this;
        _super.apply(this, arguments);
        this.containerRefHandler = function (r) { return _this.containerElement = r; };
        this.monthArrowRefHandler = function (r) { return _this.monthArrowElement = r; };
        this.yearArrowRefHandler = function (r) { return _this.yearArrowElement = r; };
        this.handleMonthSelectChange = function (e) {
            var month = parseInt(e.target.value, 10);
            core_1.Utils.safeInvoke(_this.props.onMonthChange, month);
        };
        this.handleYearSelectChange = function (e) {
            var year = parseInt(e.target.value, 10);
            core_1.Utils.safeInvoke(_this.props.onYearChange, year);
        };
    }
    DatePickerCaption.prototype.render = function () {
        var _a = this.props, date = _a.date, locale = _a.locale, localeUtils = _a.localeUtils, minDate = _a.minDate, maxDate = _a.maxDate;
        var minYear = minDate.getFullYear();
        var maxYear = maxDate.getFullYear();
        var displayMonth = date.getMonth();
        var displayYear = date.getFullYear();
        // build the list of available months, limiting based on minDate and maxDate as necessary
        var months = localeUtils.getMonths(locale);
        var startMonth = (displayYear === minYear) ? minDate.getMonth() : 0;
        var endMonth = (displayYear === maxYear) ? maxDate.getMonth() + 1 : undefined;
        var monthOptionElements = months.map(function (name, i) {
            return React.createElement("option", {key: i, value: i.toString()}, name);
        }).slice(startMonth, endMonth);
        var years = [minYear];
        for (var year = minYear + 1; year <= maxYear; ++year) {
            years.push(year);
        }
        var yearOptionElements = years.map(function (year, i) {
            return React.createElement("option", {key: i, value: year.toString()}, year);
        });
        this.displayedMonthText = months[displayMonth];
        this.displayedYearText = displayYear.toString();
        var caretClasses = classNames("pt-icon-standard", "pt-icon-caret-down", Classes.DATEPICKER_CAPTION_CARET);
        return (React.createElement("div", {className: Classes.DATEPICKER_CAPTION, ref: this.containerRefHandler}, 
            React.createElement("div", {className: Classes.DATEPICKER_CAPTION_SELECT}, 
                React.createElement("select", {className: Classes.DATEPICKER_MONTH_SELECT, onChange: this.handleMonthSelectChange, value: displayMonth.toString()}, monthOptionElements), 
                React.createElement("span", {className: caretClasses, ref: this.monthArrowRefHandler})), 
            React.createElement("div", {className: Classes.DATEPICKER_CAPTION_SELECT}, 
                React.createElement("select", {className: Classes.DATEPICKER_YEAR_SELECT, onChange: this.handleYearSelectChange, value: displayYear.toString()}, yearOptionElements), 
                React.createElement("span", {className: caretClasses, ref: this.yearArrowRefHandler}))));
    };
    DatePickerCaption.prototype.componentDidMount = function () {
        this.positionArrows();
    };
    DatePickerCaption.prototype.componentDidUpdate = function () {
        this.positionArrows();
    };
    DatePickerCaption.prototype.positionArrows = function () {
        // pass our container element to the measureTextWidth utility to ensure
        // that we're measuring the width of text as sized within this component.
        var textClass = "pt-datepicker-caption-measure";
        var monthWidth = Utils.measureTextWidth(this.displayedMonthText, textClass, this.containerElement);
        this.monthArrowElement.setAttribute("style", "left:" + monthWidth);
        var yearWidth = Utils.measureTextWidth(this.displayedYearText, textClass, this.containerElement);
        this.yearArrowElement.setAttribute("style", "left:" + yearWidth);
    };
    return DatePickerCaption;
}(React.Component));
exports.DatePickerCaption = DatePickerCaption;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kYXRlUGlja2VyQ2FwdGlvbi50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0dBS0c7Ozs7Ozs7QUFFSCxxQkFBd0MsbUJBQW1CLENBQUMsQ0FBQTtBQUM1RCxJQUFZLFVBQVUsV0FBTSxZQUFZLENBQUMsQ0FBQTtBQUN6QyxJQUFZLEtBQUssV0FBTSxPQUFPLENBQUMsQ0FBQTtBQUUvQixJQUFZLE9BQU8sV0FBTSxrQkFBa0IsQ0FBQyxDQUFBO0FBQzVDLElBQVksS0FBSyxXQUFNLGdCQUFnQixDQUFDLENBQUE7QUFpQnhDO0lBQXVDLHFDQUE0QztJQUFuRjtRQUFBLGlCQXNHQztRQXRHc0MsOEJBQTRDO1FBOEV2RSx3QkFBbUIsR0FBRyxVQUFDLENBQWMsSUFBSyxPQUFBLEtBQUksQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLEVBQXpCLENBQXlCLENBQUM7UUFDcEUseUJBQW9CLEdBQUcsVUFBQyxDQUFjLElBQUssT0FBQSxLQUFJLENBQUMsaUJBQWlCLEdBQUcsQ0FBQyxFQUExQixDQUEwQixDQUFDO1FBQ3RFLHdCQUFtQixHQUFHLFVBQUMsQ0FBYyxJQUFLLE9BQUEsS0FBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsRUFBekIsQ0FBeUIsQ0FBQztRQWFwRSw0QkFBdUIsR0FBRyxVQUFDLENBQXFDO1lBQ3BFLElBQU0sS0FBSyxHQUFHLFFBQVEsQ0FBRSxDQUFDLENBQUMsTUFBNEIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDbEUsWUFBYyxDQUFDLFVBQVUsQ0FBQyxLQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMvRCxDQUFDLENBQUE7UUFFTywyQkFBc0IsR0FBRyxVQUFDLENBQXFDO1lBQ25FLElBQU0sSUFBSSxHQUFHLFFBQVEsQ0FBRSxDQUFDLENBQUMsTUFBNEIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDakUsWUFBYyxDQUFDLFVBQVUsQ0FBQyxL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Y2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTUgUGFsYW50aXIgVGVjaG5vbG9naWVzLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQlNELTMgTGljZW5zZSBhcyBtb2RpZmllZCAodGhlIOKAnExpY2Vuc2XigJ0pOyB5b3UgbWF5IG9idGFpbiBhIGNvcHlcbiAqIG9mIHRoZSBsaWNlbnNlIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9wYWxhbnRpci9ibHVlcHJpbnQvYmxvYi9tYXN0ZXIvTElDRU5TRVxuICogYW5kIGh0dHBzOi8vZ2l0aHViLmNvbS9wYWxhbnRpci9ibHVlcHJpbnQvYmxvYi9tYXN0ZXIvUEFURU5UU1xuICovXG5cbmltcG9ydCB7IFV0aWxzIGFzIEJsdWVwcmludFV0aWxzIH0gZnJvbSBcIkBibHVlcHJpbnRqcy9jb3JlXCI7XG5pbXBvcnQgKiBhcyBjbGFzc05hbWVzIGZyb20gXCJjbGFzc25hbWVzXCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tIFwicmVhY3RcIjtcblxuaW1wb3J0ICogYXMgQ2xhc3NlcyBmcm9tIFwiLi9jb21tb24vY2xhc3Nlc1wiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSBcIi4vY29tbW9uL3V0aWxzXCI7XG5pbXBvcnQgeyBJRGF0ZVBpY2tlckxvY2FsZVV0aWxzIH0gZnJvbSBcIi4vZGF0ZVBpY2tlckNvcmVcIjtcblxuZXhwb3J0IGludGVyZmFjZSBJRGF0ZVBpY2tlckNhcHRpb25Qcm9wcyB7XG4gICAgbWF4RGF0ZTogRGF0ZTtcbiAgICBtaW5EYXRlOiBEYXRlO1xuICAgIG9uTW9udGhDaGFuZ2U/OiAobW9udGg6IG51bWJlcikgPT4gdm9pZDtcbiAgICBvblllYXJDaGFuZ2U/OiAoeWVhcjogbnVtYmVyKSA9PiB2b2lkO1xuXG4gICAgLy8gbm9ybWFsbHkgd2UgY291bGQgZXh0ZW5kIFJlYWN0RGF5UGlja2VyLkNhcHRpb25FbGVtZW50UHJvcHMsXG4gICAgLy8gYnV0IHdlIGRvbid0IHdhbnQgdG8gaW50cm9kdWNlIGEgdHlwaW5nIGRlcGVuZGVuY3ksIHNvIG1hbnVhbGx5IGFkZCBwcm9wcyBoZXJlXG4gICAgZGF0ZT86IERhdGU7XG4gICAgbG9jYWxlVXRpbHM/OiBJRGF0ZVBpY2tlckxvY2FsZVV0aWxzO1xuICAgIGxvY2FsZT86IHN0cmluZztcbiAgICBvbkNsaWNrPzogUmVhY3QuTW91c2VFdmVudEhhbmRsZXI8SFRNTEVsZW1lbnQ+O1xufVxuXG5leHBvcnQgY2xhc3MgRGF0ZVBpY2tlckNhcHRpb24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SURhdGVQaWNrZXJDYXB0aW9uUHJvcHMsIHt9PiB7XG4gICAgcHJpdmF0ZSBkaXNwbGF5ZWRNb250aFRleHQ6IHN0cmluZztcbiAgICBwcml2YXRlIGRpc3BsYXllZFllYXJUZXh0OiBzdHJpbmc7XG5cbiAgICBwcml2YXRlIGNvbnRhaW5lckVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgbW9udGhBcnJvd0VsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgeWVhckFycm93RWxlbWVudDogSFRNTEVsZW1lbnQ7XG5cbiAgICBwdWJsaWMgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7IGRhdGUsIGxvY2FsZSwgbG9jYWxlVXRpbHMsIG1pbkRhdGUsIG1heERhdGUgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IG1pblllYXIgPSBtaW5EYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIGNvbnN0IG1heFllYXIgPSBtYXhEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIGNvbnN0IGRpc3BsYXlNb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgY29uc3QgZGlzcGxheVllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICAgICAgLy8gYnVpbGQgdGhlIGxpc3Qgb2YgYXZhaWxhYmxlIG1vbnRocywgbGltaXRpbmcgYmFzZWQgb24gbWluRGF0ZSBhbmQgbWF4RGF0ZSBhcyBuZWNlc3NhcnlcbiAgICAgICAgY29uc3QgbW9udGhzID0gbG9jYWxlVXRpbHMuZ2V0TW9udGhzKGxvY2FsZSk7XG4gICAgICAgIGNvbnN0IHN0YXJ0TW9udGggPSAoZGlzcGxheVllYXIgPT09IG1pblllYXIpID8gbWluRGF0ZS5nZXRNb250aCgpIDogMDtcbiAgICAgICAgY29uc3QgZW5kTW9udGggPSAoZGlzcGxheVllYXIgPT09IG1heFllYXIpID8gbWF4RGF0ZS5nZXRNb250aCgpICsgMSA6IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgbW9udGhPcHRpb25FbGVtZW50cyA9IG1vbnRocy5tYXAoKG5hbWUsIGkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiA8b3B0aW9uIGtleT17aX0gdmFsdWU9e2kudG9TdHJpbmcoKX0+e25hbWV9PC9vcHRpb24+O1xuICAgICAgICB9KS5zbGljZShzdGFydE1vbnRoLCBlbmRNb250aCk7XG5cbiAgICAgICAgY29uc3QgeWVhcnMgPSBbbWluWWVhcl07XG4gICAgICAgIGZvciAobGV0IHllYXIgPSBtaW5ZZWFyICsgMTsgeWVhciA8PSBtYXhZZWFyOyArK3llYXIpIHtcbiAgICAgICAgICAgIHllYXJzLnB1c2goeWVhcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeWVhck9wdGlvbkVsZW1lbnRzID0geWVhcnMubWFwKCh5ZWFyLCBpKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gPG9wdGlvbiBrZXk9e2l9IHZhbHVlPXt5ZWFyLnRvU3RyaW5nKCl9Pnt5ZWFyfTwvb3B0aW9uPjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5kaXNwbGF5ZWRNb250aFRleHQgPSBtb250aHNbZGlzcGxheU1vbnRoXTtcbiAgICAgICAgdGhpcy5kaXNwbGF5ZWRZZWFyVGV4dCA9IGRpc3BsYXlZZWFyLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgY29uc3QgY2FyZXRDbGFzc2VzID0gY2xhc3NOYW1lcyhcInB0LWljb24tc3RhbmRhcmRcIiwgXCJwdC1pY29uLWNhcmV0LWRvd25cIiwgQ2xhc3Nlcy5EQVRFUElDS0VSX0NBUFRJT05fQ0FSRVQpO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Q2xhc3Nlcy5EQVRFUElDS0VSX0NBUFRJT059XG4gICAgICAgICAgICAgICAgcmVmPXt0aGlzLmNvbnRhaW5lclJlZkhhbmRsZXJ9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e0NsYXNzZXMuREFURVBJQ0tFUl9DQVBUSU9OX1NFTEVDVH0+XG4gICAgICAgICAgICAgICAgICAgIDxzZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Q2xhc3Nlcy5EQVRFUElDS0VSX01PTlRIX1NFTEVDVH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZU1vbnRoU2VsZWN0Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2Rpc3BsYXlNb250aC50b1N0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICB7bW9udGhPcHRpb25FbGVtZW50c31cbiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NhcmV0Q2xhc3Nlc31cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17dGhpcy5tb250aEFycm93UmVmSGFuZGxlcn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Q2xhc3Nlcy5EQVRFUElDS0VSX0NBUFRJT05fU0VMRUNUfT5cbiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtDbGFzc2VzLkRBVEVQSUNLRVJfWUVBUl9TRUxFQ1R9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVZZWFyU2VsZWN0Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2Rpc3BsYXlZZWFyLnRvU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHt5ZWFyT3B0aW9uRWxlbWVudHN9XG4gICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjYXJldENsYXNzZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMueWVhckFycm93UmVmSGFuZGxlcn1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbkFycm93cygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb25BcnJvd3MoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNvbnRhaW5lclJlZkhhbmRsZXIgPSAocjogSFRNTEVsZW1lbnQpID0+IHRoaXMuY29udGFpbmVyRWxlbWVudCA9IHI7XG4gICAgcHJpdmF0ZSBtb250aEFycm93UmVmSGFuZGxlciA9IChyOiBIVE1MRWxlbWVudCkgPT4gdGhpcy5tb250aEFycm93RWxlbWVudCA9IHI7XG4gICAgcHJpdmF0ZSB5ZWFyQXJyb3dSZWZIYW5kbGVyID0gKHI6IEhUTUxFbGVtZW50KSA9PiB0aGlzLnllYXJBcnJvd0VsZW1lbnQgPSByO1xuXG4gICAgcHJpdmF0ZSBwb3NpdGlvbkFycm93cygpIHtcbiAgICAgICAgLy8gcGFzcyBvdXIgY29udGFpbmVyIGVsZW1lbnQgdG8gdGhlIG1lYXN1cmVUZXh0V2lkdGggdXRpbGl0eSB0byBlbnN1cmVcbiAgICAgICAgLy8gdGhhdCB3ZSdyZSBtZWFzdXJpbmcgdGhlIHdpZHRoIG9mIHRleHQgYXMgc2l6ZWQgd2l0aGluIHRoaXMgY29tcG9uZW50LlxuICAgICAgICBjb25zdCB0ZXh0Q2xhc3MgPSBcInB0LWRhdGVwaWNrZXItY2FwdGlvbi1tZWFzdXJlXCI7XG4gICAgICAgIGNvbnN0IG1vbnRoV2lkdGggPSBVdGlscy5tZWFzdXJlVGV4dFdpZHRoKHRoaXMuZGlzcGxheWVkTW9udGhUZXh0LCB0ZXh0Q2xhc3MsIHRoaXMuY29udGFpbmVyRWxlbWVudCk7XG4gICAgICAgIHRoaXMubW9udGhBcnJvd0VsZW1lbnQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgYGxlZnQ6JHttb250aFdpZHRofWApO1xuXG4gICAgICAgIGNvbnN0IHllYXJXaWR0aCA9IFV0aWxzLm1lYXN1cmVUZXh0V2lkdGgodGhpcy5kaXNwbGF5ZWRZZWFyVGV4dCwgdGV4dENsYXNzLCB0aGlzLmNvbnRhaW5lckVsZW1lbnQpO1xuICAgICAgICB0aGlzLnllYXJBcnJvd0VsZW1lbnQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgYGxlZnQ6JHt5ZWFyV2lkdGh9YCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVNb250aFNlbGVjdENoYW5nZSA9IChlOiBSZWFjdC5Gb3JtRXZlbnQ8SFRNTFNlbGVjdEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIGNvbnN0IG1vbnRoID0gcGFyc2VJbnQoKGUudGFyZ2V0IGFzIEhUTUxTZWxlY3RFbGVtZW50KS52YWx1ZSwgMTApO1xuICAgICAgICBCbHVlcHJpbnRVdGlscy5zYWZlSW52b2tlKHRoaXMucHJvcHMub25Nb250aENoYW5nZSwgbW9udGgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlWWVhclNlbGVjdENoYW5nZSA9IChlOiBSZWFjdC5Gb3JtRXZlbnQ8SFRNTFNlbGVjdEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIGNvbnN0IHllYXIgPSBwYXJzZUludCgoZS50YXJnZXQgYXMgSFRNTFNlbGVjdEVsZW1lbnQpLnZhbHVlLCAxMCk7XG4gICAgICAgIEJsdWVwcmludFV0aWxzLnNhZmVJbnZva2UodGhpcy5wcm9wcy5vblllYXJDaGFuZ2UsIHllYXIpO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
